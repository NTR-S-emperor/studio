# Use index.php as default
DirectoryIndex index.php index.html

# Allow access to all files
Require all granted

# Fallback for older Apache versions
<IfModule !mod_authz_core.c>
    Order allow,deny
    Allow from all
</IfModule>

# Allow common file types
<FilesMatch "\.(html|css|js|txt|png|jpg|jpeg|gif|svg|ico|php|mp4|webm|ogg|mp3|wav|m4a)$">
    Require all granted
</FilesMatch>

<IfModule mod_headers.c>
    # Long cache for all static assets (1 year) - cache busting via ?v=hash
    <FilesMatch "\.(js|css|txt|json|png|jpg|jpeg|gif|svg|webp|ico|mp4|webm|ogg|mp3|wav|m4a|woff|woff2|ttf|eot)$">
        Header set Cache-Control "public, max-age=31536000, immutable"
    </FilesMatch>

    # HTML must always revalidate (entry point)
    <FilesMatch "\.(html)$">
        Header set Cache-Control "no-cache, must-revalidate"
        Header set CDN-Cache-Control "no-store"
        Header set Cloudflare-CDN-Cache-Control "no-store"
    </FilesMatch>

    # PHP always fresh
    <FilesMatch "\.(php)$">
        Header set Cache-Control "no-cache, no-store, must-revalidate"
        Header set CDN-Cache-Control "no-store"
        Header set Cloudflare-CDN-Cache-Control "no-store"
    </FilesMatch>
</IfModule>
